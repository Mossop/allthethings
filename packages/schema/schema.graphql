scalar DateTime

type TaskInfo {
  due: DateTime
  done: DateTime
}

type PluginDetail {
  pluginId: String!
  fields: String!
}

type FileDetail {
  filename: String!
  mimetype: String!
  size: Int!
}

type NoteDetail {
  note: String!
}

type LinkDetail {
  icon: String
  url: String!
}

union ItemDetail = PluginDetail | LinkDetail | NoteDetail | FileDetail

type Item {
  id: ID!
  summary: String!
  created: DateTime!
  archived: DateTime
  snoozed: DateTime

  taskInfo: TaskInfo
  detail: ItemDetail
}

interface TaskList {
  remainingTasks: Int!
  subprojects: [Project!]!
  sections: [Section!]!
  items: [Item!]!
}

interface ProjectRoot implements TaskList {
  # TaskList
  remainingTasks: Int!
  subprojects: [Project!]!
  sections: [Section!]!
  items: [Item!]!

  projects: [Project!]!
  projectById(id: ID!): Project
}

type User implements ProjectRoot & TaskList {
  # TaskList
  remainingTasks: Int!
  subprojects: [Project!]!
  sections: [Section!]!
  items: [Item!]!

  # ProjectRoot
  projects: [Project!]!
  projectById(id: ID!): Project

  id: ID!
  email: String!
  contexts: [Context!]!
  inbox: Inbox!
}

type Context implements ProjectRoot & TaskList {
  # TaskList
  remainingTasks: Int!
  subprojects: [Project!]!
  sections: [Section!]!
  items: [Item!]!

  # ProjectRoot
  projects: [Project!]!
  projectById(id: ID!): Project

  id: ID!
  user: User!
  stub: String!
  name: String!
}

type Project implements TaskList {
  # TaskList
  remainingTasks: Int!
  subprojects: [Project!]!
  sections: [Section!]!
  items: [Item!]!

  id: ID!
  stub: String!
  name: String!
  taskList: TaskList!
}

type Section {
  remainingTasks: Int!
  items: [Item!]!

  id: ID!
  name: String!
}

type Inbox {
  id: ID!
  items: [Item!]!
}

type Query {
  user: User

  taskList(id: ID!): TaskList
  root(id: ID!): ProjectRoot
}

input ContextParams {
  name: String!
}

input ProjectParams {
  name: String!
}

input SectionParams {
  name: String!
}

input ItemParams {
  summary: String!
  archived: DateTime
  snoozed: DateTime
}

input TaskInfoParams {
  due: DateTime
  done: DateTime
}

input LinkDetailParams {
  url: String!
}

input NoteDetailParams {
  note: String!
}

type Mutation {
  login(email: String!, password: String!): User
  logout: Boolean

  createContext(params: ContextParams!): Context!
  editContext(id: ID!, params: ContextParams!): Context
  deleteContext(id: ID!): Boolean!

  createProject(taskList: ID, params: ProjectParams!): Project!
  moveProject(id: ID!, taskList: ID): Project
  editProject(id: ID!, params: ProjectParams!): Project
  deleteProject(id: ID!): Boolean!

  createSection(taskList: ID, before: ID, params: SectionParams!): Section!
  moveSection(id: ID!, taskList: ID, before: ID): Section
  editSection(id: ID!, params: SectionParams!): Section
  deleteSection(id: ID!): Boolean!

  createTask(list: ID, item: ItemParams!, taskInfo: TaskInfoParams!): Item!
  createNote(list: ID, item: ItemParams!, detail: NoteDetailParams!, taskInfo: TaskInfoParams): Item!
  createLink(list: ID, item: ItemParams!, detail: LinkDetailParams!, taskInfo: TaskInfoParams): Item!

  editItem(id: ID!, item: ItemParams!): Item
  editTaskInfo(id: ID!, taskInfo: TaskInfoParams): Item

  moveItem(id: ID!, parent: ID, before: ID): Item
  deleteItem(id: ID!): Boolean!
}
