type User @entity {
  id: ID! @id
  email: String! @column
  password: String! @column

  contexts: [Context!]!
  emptyContext: EmptyContext
}

union ProjectContext = Context | EmptyContext

type Context @entity {
  id: ID! @id
  user: User! @link
  name: String! @column(overrideType: "string | null")

  projects: [Project!]!
}

type EmptyContext {
  user: User! @link

  projects: [Project!]!
}

type Project @entity {
  id: ID! @id
  parent: Project @link
  context: ProjectContext @column(overrideType: "ObjectID")
  name: String @column

  subprojects: [Project!]!
}

type Query {
  user: User
  context(id: ID!): Context
}

type Mutation {
  login(email: String!, password: String!): User
  logout: Boolean

  createContext(name: String!): Context!
  createProject(name: String!, parent: ID, context: ID): Project!
  assignContext(project: ID!, context: ID): Project
  assignParent(project: ID!, parent: ID): Project
}
